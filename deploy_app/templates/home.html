<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Monitor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Sora:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ink: #0f0f0f;
            --paper: #f4f1eb;
            --accent: #c8401a;
            --muted: #8a8578;
            --border: #d6d0c4;
            --card: #fdfbf7;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Sora', sans-serif;
            background: var(--paper);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            position: relative;
            overflow: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(var(--border) 1px, transparent 1px),
                linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 60px 60px;
            opacity: 0.35;
            pointer-events: none;
        }

        .corner-label {
            position: fixed;
            font-family: 'DM Mono', monospace;
            font-size: 0.65rem;
            color: var(--muted);
            letter-spacing: 0.08em;
            text-transform: uppercase;
        }
        .corner-label.tl { top: 24px; left: 28px; }
        .corner-label.tr { top: 24px; right: 28px; text-align: right; }
        .corner-label.bl { bottom: 24px; left: 28px; }
        .corner-label.br { bottom: 24px; right: 28px; text-align: right; }

        .live-clock {
            font-family: 'DM Mono', monospace;
            font-size: 0.75rem;
            color: var(--muted);
            letter-spacing: 0.05em;
        }

        .container {
            position: relative;
            z-index: 1;
            text-align: center;
            max-width: 480px;
            width: 100%;
        }

        .eyebrow {
            font-family: 'DM Mono', monospace;
            font-size: 0.7rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--accent);
            margin-bottom: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .eyebrow::before,
        .eyebrow::after {
            content: '';
            display: block;
            width: 32px;
            height: 1px;
            background: var(--accent);
        }

        h1 {
            font-size: 2.6rem;
            font-weight: 700;
            color: var(--ink);
            line-height: 1.15;
            letter-spacing: -0.04em;
            margin-bottom: 14px;
        }

        h1 span { color: var(--accent); }

        .subtitle {
            font-size: 0.9rem;
            color: var(--muted);
            font-weight: 300;
            margin-bottom: 52px;
            line-height: 1.6;
        }

        .btn-wrap {
            display: inline-block;
            position: relative;
        }

        .btn-shadow {
            position: absolute;
            inset: 0;
            background: var(--ink);
            border-radius: 6px;
            transform: translate(4px, 4px);
        }

        .btn {
            position: relative;
            z-index: 1;
            background: var(--accent);
            color: #fff;
            border: 2px solid var(--ink);
            padding: 15px 52px;
            font-size: 0.9rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Sora', sans-serif;
            font-weight: 600;
            letter-spacing: 0.04em;
            text-transform: uppercase;
            transition: transform 0.15s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn:hover  { transform: translate(-2px, -2px); }
        .btn:active { transform: translate(2px, 2px); }

        .btn .spinner {
            display: none;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.4);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .btn.loading .spinner   { display: block; }
        .btn.loading .btn-text  { opacity: 0.7; }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
            display: inline-block;
            animation: pulse-dot 2s ease infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { box-shadow: 0 0 0 2px rgba(34,197,94,0.25); }
            50%       { box-shadow: 0 0 0 6px rgba(34,197,94,0.1); }
        }

        .meta-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 40px;
            font-family: 'DM Mono', monospace;
            font-size: 0.7rem;
            color: var(--muted);
        }

        .meta-row span {
            display: flex;
            align-items: center;
            gap: 6px;
        }
    </style>
</head>
<body>
    <div class="corner-label tl">SYS-MON</div>
    <div class="corner-label tr live-clock" id="corner-clock"></div>
    <div class="corner-label bl">CLOUD RUN by Satyam</div>
    <div class="corner-label br">copyright @ SATYAM</div>

    <div class="container">
        <div class="eyebrow">Satyam says HELLO from cloud Run</div>
        <h1>System <span>Health</span><br>Monitor</h1>
        <p class="subtitle">Real-time CPU &amp; memory diagnostics<br>deployed on Google Cloud Run</p>

        <div class="btn-wrap">
            <div class="btn-shadow"></div>
            <button class="btn" id="analyzeBtn" onclick="analyze()">
                <span class="btn-text">Run Analysis</span>
                <div class="spinner"></div>
            </button>
        </div>

        <div class="meta-row">
            <span><span class="status-dot"></span> System Online</span>
            <span>/ <span id="live-uptime">--</span></span>
            <span>/ <span id="live-date">--</span></span>
        </div>
    </div>

    <script>
        function updateClock() {
            const now = new Date();
            document.getElementById('corner-clock').textContent =
                now.toLocaleTimeString('en-US', { hour12: false });
            document.getElementById('live-date').textContent =
                now.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
        }
        updateClock();
        setInterval(updateClock, 1000);

        let cachedUptime = 0;
        fetch('/uptime').then(r => r.json()).then(d => {
            cachedUptime = d.uptime_seconds;
            function tick() {
                const h = Math.floor(cachedUptime / 3600);
                const m = Math.floor((cachedUptime % 3600) / 60);
                const s = cachedUptime % 60;
                document.getElementById('live-uptime').textContent =
                    `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')} uptime`;
                cachedUptime++;
            }
            tick();
            setInterval(tick, 1000);
        });

        function analyze() {
            const btn = document.getElementById('analyzeBtn');
            btn.classList.add('loading');
            btn.disabled = true;
            fetch('/analyze')
                .then(res => res.json())
                .then(data => {
                    localStorage.setItem('data', JSON.stringify(data));
                    window.location.href = '/dashboard';
                })
                .catch(e => {
                    btn.classList.remove('loading');
                    btn.disabled = false;
                    alert('Error: ' + e);
                });
        }
    </script>
</body>
</html>
